---
layout: post
title: Automagic Prefixes for Model Fields
date: '2009-06-23T12:40:00-04:00'
tags:
- php
- kohana
tumblr_url: https://seanmonstar.com/post/708669460/automagic-prefixes-for-model-fields
---
<p>Say we have a player model, and every field in <code>players</code>table is prepended with <em>player_</em>. For example, <code>player_username</code>, <code>player_email</code>, etc.</p>
<p>I&rsquo;m personally not used to this database design, but I know plenty of people use it. When I work on projects that have this, I&rsquo;m not particularly found of having to write:</p>
<pre><code>$p = new Player;
echo $p-&gt;player_username;</code></pre>
<p>I&rsquo;d rather ditch the prepended part in all my PHP code.</p>
<pre><code>echo $p-&gt;username;</code></pre>
<h4>Use Accessors</h4>
<p>We can do this by <a href="http://seanmonstar.com/2023/2008-12-18-overloading-objects-in-php/">writing some __get and __set functions</a>:</p>
<pre><code>public function __get($name) {    
	$prepend = 'player_'.$name;    
	if(isset($this-&gt;$prepend)) {        
	return $this-&gt;$prepend;    
	}    
	return parent::__get($name);
}

public function __set($name, $value) {    
	$prepend = 'player_'.$name;    
	if(isset($this-&gt;$prepend)) {        
		$this-&gt;$prepend = $value;    
	} else {        
		parent::__set($name, $value);        
		//if no parent, you might want the default:        
		//$this-&gt;$name = $value    
	}
}</code></pre>
<p>Basically, <a href="http://seanmonstar.com/2023/2008-12-18-overloading-objects-in-php/">stated before</a>, these get called when you try to access a property that doesn&rsquo;t exist on the object.  So when we try to access <code>username</code>, we check if <code>player_username</code> exists, and if so, return that value.</p>
<h4>MY_Model: Easily extendable</h4>
<p>You could work this into a MY_Model class that extends Model, and then make all your models extend MY_Model.  If you wanted to do this, I&rsquo;d say make a property of MY_Model called &lsquo;prefix&rsquo;, and use prefix in the accesors.  Then, in each sub-class, all you need to do is define the prefix.</p>
<pre><code>class MY_Model extends Model {    
	protected $prefix;    
	public function __get($name) {        
		$prepend = $this-&gt;prefix.$name;        
		//...    
	}   
}</code></pre>
<pre><code>class Player_Model extends MY_Model {    
	protected $prefix = 'player_'; 
}</code></pre>
