---
layout: post
title: Get the Method Caller in MooTools
date: '2010-01-19T09:48:00-08:00'
tags:
- javascript
- mootools
tumblr_url: http://seanmonstar.com/post/708933763/get-the-method-caller-in-mootools
---
<p>As I continue to work on my MVC implementation in MooTools, I continue to find new hidden features in MooTools. This weekend, I was adding a view method to the controller, as a shortcut to creating a new View and rendering it. One of the arguments is the view file name, but I also wanted some automagic like CakePHP. It&rsquo;d be great if the view function could determine the file name based on the function that called it.</p>
<p>Here&rsquo;s what I mean:</p>
<pre><code>var ItemsController = new Class({
	view: function(view_name) {
		if(!view_name) {
			//viewname should default to 'controller/method'
		}
	},
	list: function() {
		$(this).grab(this.view()); // 'items/list'
	}
});</code></pre>
<p>Every method in a MooTools Class is wrapped in some decorators, that set the caller on the function object when called. By staring and counting how many methods back I needed to collect, I&rsquo;ve accomplished my goal. However, <strong>this won&rsquo;t work if a standard function calls this method</strong>. It might be a good idea to <a href="http://seanmonstar.com/2009/09/04/protected-methods-in-mootools-classes.html">protect this method</a>, now that I think about it.</p>
<pre><code>//inside view function
view_name = arguments.callee.caller.caller.caller._name;</code></pre>
<p>Don&rsquo;t believe me? Test it right here. As neat as this is, <em>I don&rsquo;t gaurantee this will work in every situation</em>, and I haven&rsquo;t tested if any browsers break using this.</p> 
<iframe style="width: 100%; height: 300px" src="http://mootools.net/shell/9QDKe/embedded/"></iframe>
