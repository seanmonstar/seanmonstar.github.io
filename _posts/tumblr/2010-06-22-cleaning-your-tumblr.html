---
layout: post
title: Cleaning Your Tumblr
date: '2010-06-22T10:53:55-07:00'
tags:
- javascript
tumblr_url: http://seanmonstar.com/post/726009563/cleaning-your-tumblr
---
<p>I originally setup my Tumblr unsure of what to use it for, so I just added a bunch of feeds to it, like my Twitter, my blog feed, my delicious links, and my github activity. But when I decided to actually use my Tumblr as a real blog, I decided I didn&rsquo;t want all that junk in here.</p>

<p>For whatever reason, Tumblr doesn&rsquo;t provide any sort of simple way to clean out a lot (<em>1000+</em>) of posts. The only way to delete posts it to scroll to the post in the dashboard, click the &ldquo;delete&rdquo; button, and wait for the <code>POST</code> to be submitted and the page reloaded, which forgets your current scroll position. I wasn&rsquo;t going to do that 1000 times.</p>

<p>Thankfully, there&rsquo;s a decent API that lets you easily receive all your posts. The posts have a field set if they had been imported through a feed. And with the dashboard using <a href="http://prototypejs.org">Prototype</a>, it was a matter of putting together 2 functions to read and delete posts, and then some minor babysitting to make sure to pause when Tumblr would throttle me.</p>

<pre><code>var keepGoing = true,
    tumblr = '',
    email = '',
    password = '',
    posts = 0;
function findFeedItems(json) {
    json.posts.each(function(p) {
        if(p['feed-item']) {
            apiDelete(p['id'])
        }
    });

    if (keepGoing) {
        apiRead.delay(20);
    }
}

function apiRead() {
    console.log('reading...');
    var nonce = new Date();
    var s = document.createElement('script');
    s.src = "http://"+tumblr+".tumblr.com/api/read/json?num=50&amp;callback=findFeedItems&amp;start=" + posts + "&amp;nonce=" + (+nonce);

    document.body.appendChild(s);
}

function apiDelete(id) {
    console.log('deleting: %s', id);
    new Ajax.Request('/api/delete', {
        method: 'post',
        parameters: 'email='+email+'&amp;password='+password+'&amp;post-id=' + id,
        onSuccess: function() {
            console.log("Successful deletion: %s", id);
        },
        onFailure: function(transport) {
            console.log('delete failed: ', transport.status);
        }
    });
}
</code></pre>

<p>While on the <a href="http://www.tumblr.com/dashboard">dashboard</a>, copy and paste this into your console, with the proper variables filled in, of course.</p>

<p>Just called <code>apiRead()</code> to get it started. When you see a delete failure, you can pause your purge by setting <code>keepGoing</code> to false. Wait a few seconds, set it back to true, and call <code>apiRead()</code> again.</p>

<p>Once you&rsquo;re no longer seeing successes or failures, but you know theres more posts, you can set the <code>posts</code> variable to 50, or 100, or higher. That will start the search farther down your posts.</p>

<p><strong>Again, this script will delete everything imported from a feed.</strong> If you want to just delete <em>everything</em>, pull out the <code>if(p['feed-item'])</code> condition, and just pass all the posts to <code>apiDelete</code>.</p>
