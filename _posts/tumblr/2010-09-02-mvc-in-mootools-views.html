---
layout: post
title: ! 'MVC in MooTools: Views'
date: '2010-09-02T09:39:00-07:00'
tags:
- mootools
- mvc
- monstars.js
tumblr_url: http://seanmonstar.com/post/1053909313/mvc-in-mootools-views
---
<p><small>This is another installment about how my <a href="http://github.com/seanmonstar/monstars.js">MooTools MVC framework</a> rocks. Check it out. If you&rsquo;re interested in the first part, check out my write-up on using <a href="http://seanmonstar.com/2010/08/25/mvc-in-mootools-models.html">Models</a>.</small></p>

<p>After you make the building blocks of your application, using <a href="http://seanmonstar.com/2010/08/25/mvc-in-mootools-models.html">Models</a>, Views are how you display that information to a user. Having written a lot of JavaScript that adds content to the page, I know just how much it can suck. You typically have two options:</p>

<ol><li>Concatenate a huge string of markup with variables, then setting the <code>innerHTML</code> of a <code>div</code>.</li>
<li>Use a bunch of <code>document.createElement</code> and <code>el.appendChild</code>, ad infinitum.</li>
</ol><p>Both are equally unappetizing. Wouldn&rsquo;t it be so much nicer to write your views like we do in other languages?</p>

<h3>Templating</h3>

<p>Here&rsquo;s a nice mix of HTML and JavaScript. No tricky string concatenation<sup id="fnref:p1053909313-1"><a href="#fn:p1053909313-1" rel="footnote">1</a></sup>. You just have to put your JavaScript inside tags like you would in PHP.</p>

<pre><code>&lt;ul id="Tasks"&gt;
&lt;% tasks.forEach(function(task) { %&gt;

    &lt;li class="task"&gt;
        &lt;input type="checkbox" /&gt;
        &lt;%= task.get('title') %&gt;
        &lt;% if(tag.get('tags').length) { 
            print(view('tasks/inline_tags', { tags: task.get('tags') }));
        } %&gt;
    &lt;/li&gt;

&lt;% }); %&gt;
&lt;/ul&gt;
</code></pre>

<h3>View.Helpers</h3>

<p>Besides <code>print</code>, which does exactly what you think it does, there are a bunch of other functions that are sort of &ldquo;globally&rdquo; accessible from a View. And these are functions defined on <code>View.Helpers</code>. The most basic version of the helpers only includes a <code>view</code> function, which let&rsquo;s you nest views inside each other, like I used above. If you include the <code>View.Helpers</code> file, you get more functions, such as <code>excerpt</code> (truncates to a certain length) and <code>date</code> (allows date formating similar to PHP&rsquo;s <a href="http://php.net/date">date</a> method). As I find more basic functions that you would want in a templating system, I&rsquo;ll add more, such as possibly something like <code>escape</code>.</p>

<h3>The File</h3>

<p>These are saved as <code>.html</code> files. You don&rsquo;t need to manually include them like Models or Controllers; the View class will first check to see if they&rsquo;ve been included, and if not, go and fetch them over the wire. And they go in you app&rsquo;s <code>views</code> folder. The example above would have a structure like so:</p>

<pre><code>js/
    views/
        tasks/
            list.html
</code></pre>

<h3>The View Class</h3>

<p>The <code>View</code> Class is what converts templates into views for your application. You can instantiate a View, and then pass it data and ask for it to process itself using the passed data.</p>

<pre><code>var myView = new View('tasks/list').render({ tasks: myTasks });
myEl.grab(myView);
myOtherEl.set('html', myView);
</code></pre>

<p>Views have both a <a href="http://mootools.net/blog/2010/03/19/a-better-way-to-use-elements/"><code>toElement</code></a> and <code>toString</code> function defined to return the processed mark-up in the proper format. This means you can simply pass the view as a parameter to most MooTools Element methods, and it just works<sup id="fnref:p1053909313-2"><a href="#fn:p1053909313-2" rel="footnote">2</a></sup>.</p>

<p>Good news, though: Controllers have a convenience method called <code>view</code> that really makes this a joy to use. I&rsquo;ll have more to say about Controllers in my next report.</p>

<div class="footnotes">
<hr><ol><li id="fn:p1053909313-1">
<p>The string concatenation is done internally. Everything in the template is turned into a string using <a href="http://ejohn.org/blog/javascript-micro-templating/">John Resig&rsquo;s micro-templating</a> suggestion. <a href="#fnref:p1053909313-1" rev="footnote">↩</a></p>
</li>

<li id="fn:p1053909313-2">
<p>Regular DOM methods might not though. <code>appendChild</code> expects an Element, and since it&rsquo;s not part of MooTools, it&rsquo;s not rigged up to called <code>toElement</code>. Also, because of the way <code>toString</code> works with Classes in Internet Explorer, this feature doesn&rsquo;t work in those browsers. MooTools 1.3 repairs that problem. <a href="#fnref:p1053909313-2" rev="footnote">↩</a></p>
</li>

</ol></div>
